# 图片识别与文档生成流程

## 1. 目录结构说明

### 1.1 图片组织结构

```
doc/参考/
├── 青云/
│   ├── 0/              # 初级状态（0级或1级）
│   │   ├── 一重/
│   │   ├── 二重/
│   │   ├── 三重/
│   │   ├── 四重/
│   │   ├── 五重/
│   │   ├── 神通/
│   │   └── 造化/
│   ├── 1/              # 满级或可推算满级状态
│   │   ├── 一重/
│   │   ├── 二重/
│   │   ├── 三重/
│   │   ├── 四重/
│   │   ├── 五重/
│   │   ├── 神通/
│   │   └── 造化/
│   └── 天书/           # 天书技能
├── 合欢/
│   └── （结构同上）
└── 通用/
    └── （结构同上）
```

### 1.2 注意事项

- **0和1文件夹的对应关系**：不是按文件名顺序一一对应，需要识别技能名称后配对
- **三代、四代文件夹**：暂时跳过，不处理
- **天书文件夹**：单独处理，生成独立的天书技能描述文档

## 2. 图片识别步骤

### 2.1 读取图片

1. 遍历指定职业的 `0` 文件夹下的某个"重"目录
2. 读取该目录下所有 `.png` 图片
3. 遍历对应的 `1` 文件夹下的同名"重"目录
4. 读取该目录下所有 `.png` 图片

### 2.2 识别技能信息

从每张图片中识别以下信息：

#### 必须识别的字段
- **技能名称**：位于图片左上角
- **当前等级/最大等级**：格式如 "0/9"、"1/9" 等
- **技能类型**：
  - 主动攻击（单体/群体/线型/扇形等）
  - 被动
  - 自身祝福
  - 群体祝福
  - 等等
- **攻击范围**：如 "单体攻击 10.7米"、"目标周围半径 8米" 等
- **施法时间**：如 "1秒"、"2秒" 等
- **技能冷却**：如 "2秒"、"6秒"、"75秒" 等
- **技能效果描述**：完整的效果描述文本

#### 不需要识别的字段
- ❌ 真气消耗
- ❌ 学习条件（人物等级、前置技能等）

#### 特殊效果识别
- 某些技能有特殊标注，如："真气贯穿+1"、"霜燃劲气+1" 等
- 需要单独提取为"特殊效果"字段

### 2.3 技能配对

1. **按技能名称配对**：
   - 从 `0` 文件夹识别出的技能
   - 在 `1` 文件夹中找到同名技能
   - 配对成功后提取两个等级的数据

2. **处理特殊情况**：
   - 如果某个技能只在 `0` 或 `1` 其中一个文件夹存在，单独记录
   - 如果两边技能数量不匹配，需要人工检查

## 3. 数据提取规则

### 3.1 数值提取

从技能描述中提取数值，区分1级和满级：

**示例1：简单数值**
```
图片0: "附加53点攻击力"
图片1: "附加85点攻击力"
→ 输出: "附加53/85点攻击力"
```

**示例2：百分比**
```
图片0: "有48%几率使目标被冰冻"
图片1: "有72%几率使目标被冰冻"
→ 输出: "有48%/72%几率使目标被冰冻"
```

**示例3：持续时间**
```
图片0: "持续4秒"
图片1: "持续12秒"
→ 输出: "持续4/12秒"
```

**示例4：多个数值组合**
```
图片0: "降低其移动速度22%"
图片1: "降低其移动速度46%"
→ 输出: "降低其移动速度22%/46%"
```

### 3.2 不变内容

如果某个属性在1级和满级时没有变化，只写一个值：

**示例**：
```
- "攻击目标1次" （次数不变）
- "单体攻击 10.7米" （距离不变）
- "施法时间 1秒" （时间不变）
- "技能冷却 2秒" （冷却不变）
```

### 3.3 多段描述

某些技能有多条效果，需要分条列出：

**示例**：
```markdown
**技能效果**:
- 攻击目标1次，附加53/85点攻击力
- 有48%/72%几率使目标被冰冻，持续4/12秒：降低其移动速度22%/46%
```

## 4. 文档生成规范

### 4.1 文档命名

- 普通技能：`{职业名}{重名}技能描述.md`
  - 示例：`青云一重技能描述.md`、`青云二重技能描述.md`
- 天书技能：`{职业名}天书技能描述.md`
  - 示例：`青云天书技能描述.md`

### 4.2 文档模板

```markdown
# {职业名}{重名}技能描述

## {技能名称}

**技能ID**: `待补充`

**最大等级**: {最大等级}

**技能类型**: {技能类型}

**攻击范围**: {攻击范围}（如果有）

**施法时间**: {施法时间}（如果有）

**技能冷却**: {技能冷却}（如果有）

**特殊效果**: {特殊效果}（如果有）

**技能效果**:
- {效果描述1}
- {效果描述2}
- ...

---

## {下一个技能}

...

---

**文档生成时间**: {日期}  
**数据来源**: 游戏截图识别
```

### 4.3 字段说明

| 字段 | 是否必填 | 说明 |
|------|---------|------|
| 技能ID | 是 | 暂时填写"待补充"，后续手动填写 |
| 最大等级 | 是 | 从图片中的 "X/Y" 格式提取 Y 值 |
| 技能类型 | 是 | 主动攻击/被动/自身祝福/群体祝福等 |
| 攻击范围 | 否 | 仅攻击类技能需要 |
| 施法时间 | 否 | 主动技能需要 |
| 技能冷却 | 否 | 主动技能需要 |
| 特殊效果 | 否 | 仅有特殊标注的技能需要 |
| 技能效果 | 是 | 详细的效果描述 |

### 4.4 被动技能特殊处理

被动技能通常没有"攻击范围"、"施法时间"、"技能冷却"等字段，模板简化为：

```markdown
## {技能名称}

**技能ID**: `待补充`

**最大等级**: {最大等级}

**技能类型**: 被动

**技能效果**:
- {效果描述}

---
```

## 5. 天书技能处理

### 5.1 天书特点

- 天书技能通常没有等级概念，或者有独特的升级方式
- 天书技能数量较多（如青云有51张图片）
- 天书技能效果通常是对其他技能的增强

### 5.2 天书文档格式

待补充（需要先查看天书图片的具体内容）

## 6. 质量检查清单

生成文档后，需要检查：

- [ ] 所有技能都已配对识别
- [ ] 技能名称正确无误
- [ ] 最大等级与图片一致
- [ ] 数值格式统一（1级/满级用"/"分隔）
- [ ] 不变的属性只写一个值
- [ ] 特殊效果已提取
- [ ] 技能类型正确分类
- [ ] 文档格式符合模板规范
- [ ] 技能ID字段预留为"待补充"

## 7. 常见问题处理

### 7.1 配对失败

**问题**：0和1文件夹中的技能无法配对

**解决方案**：
1. 检查技能名称是否完全一致（注意空格、标点）
2. 检查是否有技能在某个文件夹中缺失
3. 人工检查图片内容，确认是否为同一技能

### 7.2 识别不完整

**问题**：某些图片识别的文字不完整或有错误

**解决方案**：
1. 重新读取图片，尝试更准确的识别
2. 对比0和1的描述，推断完整内容
3. 必要时人工检查图片并补充

### 7.3 数值推算

**问题**：某些技能缺少满级图片，需要推算

**解决方案**：
- 如果成长规律明确，可以按等级线性推算
- 推算的数值需要在文档中标注 `（推测）`
- 示例：`附加53/85点攻击力（满级推测）`

## 8. 批量处理流程

处理完整职业的技能描述：

```
1. 处理一重技能 → 生成 {职业名}一重技能描述.md
2. 处理二重技能 → 生成 {职业名}二重技能描述.md
3. 处理三重技能 → 生成 {职业名}三重技能描述.md
4. 处理四重技能 → 生成 {职业名}四重技能描述.md
5. 处理五重技能 → 生成 {职业名}五重技能描述.md
6. 处理神通技能 → 生成 {职业名}神通技能描述.md
7. 处理造化技能 → 生成 {职业名}造化技能描述.md
8. 处理天书技能 → 生成 {职业名}天书技能描述.md
```

**跳过**：三代、四代文件夹

---

**最后更新**: 2025-11-04  
**维护者**: AI Assistant

